# 论文笔记：持续对比强化学习(Continual Contrastive Reinforcement Learning, CCRL)

> **Environment-aware fault diagnosis of aero-engines under highly imbalance scenarios.**
> 
> **Paper Title**: Continual contrastive reinforcement learning: Towards stronger agent for environment-aware fault diagnosis of aero-engines through long-term optimization under highly imbalance scenarios
> 
> **Journal**: *Advanced Engineering Informatics* (Elsevier), Vol. 65, 2025
> 
> **DOI**: [10.1016/j.aei.2025.103297](https://doi.org/10.1016/j.aei.2025.103297)

<!-- Badge区域，模拟截图中的样式 -->
![DOI](https://img.shields.io/badge/DOI-10.1016%2Fj.aei.2025.103297-007ec6)
![Status](https://img.shields.io/badge/Status-Published-success)
![Topic](https://img.shields.io/badge/Topic-Reinforcement%20Learning%20%7C%20Fault%20Diagnosis-orange)

---

## 目录
- [1. 背景与问题](#1-背景与问题)
- [2. 核心思路](#2-核心思路)
- [3. 方法详解](#3-方法详解)
    - [3.1 环境交互机制](#31-环境交互机制)
    - [3.2 特征区分模块（对比学习）](#32-特征区分模块对比学习)
    - [3.3 故障识别模块（强化学习）](#33-故障识别模块强化学习)
- [4. 实验验证](#4-实验验证)
- [5. 总结](#5-总结)
- [文献来源](#文献来源)

---

## 1. 背景与问题

航空发动机是飞机的核心部件，其可靠性至关重要。在实际的运维和故障诊断中，工程人员面临着三个主要挑战：

1.  **样本高度不平衡**：发动机的设计非常精密，大部分时间处于正常运行状态，故障数据（尤其是特定类型的故障）非常稀缺。传统的深度学习模型需要大量且均衡的样本才能训练好，面对这种“正常样本多、故障样本极少”的情况，识别准确率往往大幅下降。
2.  **环境动态变化**：飞机的飞行环境、气候条件以及发动机自身的老化程度都在不断变化。一个在特定数据集上训练好的静态模型，很难适应未来的新情况。
3.  **数据持续增长**：航空公司每天都会产生大量的飞行数据，传统方法难以利用这些新数据对模型进行实时更新。

为了解决上述问题，本论文提出了一种名为 **CCRL (Continual Contrastive Reinforcement Learning，持续对比强化学习)** 的方法。该方法旨在构建一个能够像人类专家一样，在长期的环境交互中不断学习、适应新数据且能处理样本不平衡的智能体。

## 2. 核心思路

该方法将故障诊断过程看作是一个**智能体（Agent）与环境（Environment）交互**的过程，主要包含以下创新点：

*   **引入环境交互**：利用航空公司实际的运营流程。飞行数据作为“状态”，地面专家的故障确认结果作为“反馈”。智能体根据反馈不断优化自身的判断策略。
*   **对比学习解决数据稀缺**：针对故障样本少的问题，设计了一个对比学习编码器。它利用大量的正常样本学习通用特征，再利用少量故障样本进行微调，通过拉近同类样本距离、推远异类样本距离，提升模型对稀缺故障的辨别能力。
*   **强化学习实现持续进化**：使用改进的Dueling Double Deep Q-Network (D3QN) 算法，结合针对不平衡样本设计的奖励机制，使模型能够在数据流中持续更新，而不是训练一次就停止。

## 3. 方法详解

CCRL框架主要由三个部分组成：环境构建、特征区分模块和类别识别模块。

### 3.1 环境交互机制

在强化学习的框架下，论文将航空公司的实际运维过程抽象为“环境”：
*   **输入（State）**：飞机通过ACARS系统传回的传感器截面数据（如EGT、燃油流量、转速等偏差值）。
*   **动作（Action）**：智能体对当前数据给出的诊断结论（是正常，还是某种特定故障）。
*   **奖励（Reward）**：如果智能体判断正确（与事后专家的维修报告CNR一致），获得正向奖励；否则获得负向奖励。

这种机制保证了模型可以随着每日新产生的数据流，不断地进行自我修正和迭代。

### 3.2 特征区分模块（对比学习）

这是解决“样本太少”问题的关键。由于故障数据很少，直接训练分类器容易过拟合。本研究分两步走：

1.  **自编码器预训练**：利用极其丰富的**正常样本**训练一个自编码器（Autoencoder）。目的是让网络学会如何高效地压缩和还原发动机的正常运行数据，掌握数据的基本规律。
2.  **对比学习微调**：基于SimCLR的思想，构建正负样本对。
    *   **正样本对**：同一故障类型的不同样本。
    *   **负样本对**：不同故障类型的样本。
    *   **目标**：调整网络参数，使得在特征空间中，相同故障的数据点聚在一起，不同故障的数据点离得越远越好。

通过这一步，即使某类故障只有几个样本，网络也能提取出最具区分度的特征。

### 3.3 故障识别模块（强化学习）

在提取到高质量特征后，论文使用 **D3QN** 算法进行最终的故障分类决策。

*   **不平衡奖励机制**：为了防止模型倾向于预测“多数类”（即正常状态），论文设计了加权奖励函数。如果模型成功识别出了稀有的故障类型，它将获得比识别出正常样本高得多的奖励权重。这迫使智能体更加关注那些“难得一见”的故障案例。
*   **双网络结构**：采用策略网络（Policy Net）和目标网络（Target Net）分离的结构，提升训练的稳定性。

## 4. 实验验证

论文使用了真实的 **CFM56-7B** 航空发动机数据集进行验证。

*   **数据构成**：包含正常样本以及三种典型故障：可变放气阀（VBV）故障、排气温度传感器（EGTI）故障、总温传感器（TAT）故障。其中故障样本数量极少（例如训练集中某类故障仅有14个样本），属于高度不平衡场景。
*   **对比基准**：
    1.  D3QN（原始强化学习）
    2.  DS+D3QN（欠采样+强化学习）
    3.  OS+D3QN（过采样+强化学习）
*   **实验结果**：
    *   **F1分数**：CCRL达到了 **84.26%**，显著优于对比方法（其它方法在68%-77%之间）。
    *   **稳定性**：在多次重复实验中，CCRL的标准差最小，说明模型在面对随机性时表现最稳定。
    *   **混淆矩阵分析**：CCRL在稀缺故障（如EGTI）上的误报率和漏报率均低于传统的数据增强方法。

## 5. 总结

本研究提出的CCRL方法，通过结合对比学习对特征的提取能力和强化学习的持续决策能力，有效地解决了航空发动机故障诊断中**数据不平衡**和**环境动态变化**的难题。它不需要凭空生成虚拟数据（如GAN），而是充分挖掘现有数据的价值，为工业界在小样本条件下的设备维护提供了一种新的解决思路。

---

## 文献来源

**Paper Title**: Continual contrastive reinforcement learning: Towards stronger agent for environment-aware fault diagnosis of aero-engines through long-term optimization under highly imbalance scenarios

**Journal**: *Advanced Engineering Informatics* (Elsevier), Vol. 65, 2025

**DOI**: [10.1016/j.aei.2025.103297](https://doi.org/10.1016/j.aei.2025.103297)
